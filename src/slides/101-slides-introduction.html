<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Lecture 101</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dr Stefano De Sabbata School of Geography, Geology, and the Env., University of Leicester github.com/sdesabbata/r-for-geographic-data-science s.desabbata@le.ac.uk | @maps4thought text licensed under CC BY-SA 4.0, code licensed under GNU GPL v3.0" />
    <meta name="date" content="2022-10-04" />
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <link rel="stylesheet" href="css/sdesabbata-uol.css" type="text/css" />
    <link rel="stylesheet" href="css/sdesabbata-uol-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Lecture 101
### Dr Stefano De Sabbata<br/><small>School of Geography, Geology, and the Env., University of Leicester<br/><a href="https://github.com/sdesabbata/r-for-geographic-data-science" style="color: white">github.com/sdesabbata/r-for-geographic-data-science</a><br/><a href="mailto:s.desabbata@le.ac.uk" style="color: white">s.desabbata@le.ac.uk</a> | <a href="https://twitter.com/maps4thought" style="color: white">@maps4thought</a><br/>text licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" style="color: white">CC BY-SA 4.0</a>, code licensed under <a href="https://www.gnu.org/licenses/gpl-3.0.html" style="color: white">GNU GPL v3.0</a></small>
### <small>2022-10-04</small>

---

class: inverse, center, middle




# Introduction to R


---

## About this module

.pull-left[

`R` is one of the most widely used languages for *(geospatial)* data science

- data wrangling
- statistical analysis
- machine learning
- data visualisation and maps
- processing spatial data
- geographic information analysis

![](101-slides-introduction_files/figure-html/unnamed-chunk-1-1.png)&lt;!-- --&gt;

]
.pull-right[

This module will provide you with the fundamental skills in

- basic programming in R
- data wrangling
- data analysis
- reproducibility

basis for

- *GY7707 Geospatial Data Analysis*
- *GY7708 Geospatial Artificial intelligence*

]



---

## Schedule

The lectures and practical sessions have been designed to follow the schedule below

- **Introduction to Reproducible Data Science**
    - 101 Introduction to R
    - 102 Reproducible data science
    - 103 Data manipulation
    - 104 Table operations
- **R Scripting**
    - 201 Control structures
    - 202 Functions
- **Data analysis**
    - 301 Exploratory visualisation
    - 302 Exploratory statistics
    - 303 Comparing data
    - 304 Regression models



---

## Reference books

Suggested reading

- *Programming Skills for Data Science: Start Writing Code to Wrangle, Analyze, and Visualize Data with R* by Michael Freeman and Joel Ross, Addison-Wesley, 2019. See book [webpage](https://www.pearson.com/us/higher-education/program/Freeman-Programming-Skills-for-Data-Science-Start-Writing-Code-to-Wrangle-Analyze-and-Visualize-Data-with-R/PGM2047488.html) and [repository](https://programming-for-data-science.github.io/).
- *R for Data Science* by Garrett Grolemund and Hadley Wickham, O'Reilly Media, 2016. See [online book](https://r4ds.had.co.nz/).
- *Discovering Statistics Using R* by Andy Field, Jeremy Miles and ZoÃ« Field, SAGE Publications Ltd, 2012. See book [webpage](https://www.discoveringstatistics.com/books/discovering-statistics-using-r/).
- *Machine Learning with R: Expert techniques for predictive modeling* by Brett Lantz, Packt Publishing, 2019. See book [webpage](https://subscription.packtpub.com/book/big_data_and_business_intelligence/9781788295864).

Further reading

- *The Art of R Programming: A Tour of Statistical Software Design* by Norman Matloff, No Starch Press, 2011. See book [webpage](https://nostarch.com/artofr.htm)
- *An Introduction to R for Spatial Analysis and Mapping* by Chris Brunsdon and Lex Comber, Sage, 2015. See book [webpage](https://uk.sagepub.com/en-gb/eur/an-introduction-to-r-for-spatial-analysis-and-mapping/book241031)
- *Geocomputation with R* by Robin Lovelace, Jakub Nowosad, Jannes Muenchow, CRC Press, 2019. See [online book](https://bookdown.org/robinlovelace/geocompr/).


---

## The R programming language

.pull-left[

&lt;br/&gt;

Created in 1992 by Ross Ihaka and Robert Gentleman at the University of Auckland, New Zealand

- Free, open-source implementation of *S*
    - statistical programming language 
    - Bell Labs

&lt;br/&gt;

- Functional programming language
- Supports (and commonly used as) procedural (i.e., imperative) programming
- Object-oriented
- Interpreted (not compiled)

]
.pull-right[

&lt;br/&gt;
&lt;br/&gt;


![](https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/R_logo.svg/1200px-R_logo.svg.png)

.right[
.referencenote[
by Hadley Wickham and others at RStudio&lt;br/&gt;
via Wikimedia Commons, CC BY-SA 4.0
]
]

]

&lt;br/&gt;




---

## Interpreting values

.pull-left[

&lt;br/&gt;

When values and operations are inputted in the *Console*, the interpreter returns the results of its interpretation of the expression


```r
2
```

```
## [1] 2
```

```r
"String value"
```

```
## [1] "String value"
```

```r
# comments are ignored
```

]
.pull-right[

&lt;br/&gt;

R provides three core data types

- numeric 
    - both integer and real numbers
- character 
    - i.e., text, also called *strings*
- logical
    - `TRUE` or `FALSE`

]

---

## Numeric operators

R provides a series of basic numeric operators

|Operator|Meaning         |Example  |Output     |
|--------|----------------|---------|-----------|
|+       |Plus            |`5 + 2`  |7  |
|-       |Minus           |`5 - 2`  |3  |
|`*`     |Product         |`5 * 2`  |10  |
|/       |Division        |`5 / 2`  |2.5  |
|%/%     |Integer division|`5 %/% 2`|2|
|%%      |Module          |`5 %% 2` |1 |
|^       |Power           |`5^2`    |25    |

&lt;br/&gt;


```r
5 + 2
```

```
## [1] 7
```



---

## Logical operators


R provides a series of basic logical operators to test

|Operator|Meaning           |Example               |Output              |
|--------|------------------|----------------------|--------------------|
|==      |Equal             |`5 == 2`              |FALSE          |
|!=      |Not equal         |`5 != 2`              |TRUE          |
|&gt; (&gt;=)  |Greater (or equal)|`5 &gt; 2`               |TRUE           |
|&lt; (&lt;=)  |Less (or equal)   |`5 &lt;= 2`              |FALSE          |
|!       |Not               |`!TRUE`               |FALSE           |
|&amp;       |And               |`TRUE &amp; FALSE`        |FALSE    |
|	&amp;#124; |Or                |`TRUE` &amp;#124; `FALSE` |TRUE    |

&lt;br/&gt;


```r
5 &gt;= 2
```

```
## [1] TRUE
```


---

## Variables

&lt;br/&gt;

Variables **store data** and can be defined 

- using an *identifier* (e.g., `a_variable`) 
- on the left of an *assignment operator* `&lt;-`
- followed by the object to be linked to the identifier
- such as a *value* (e.g., `1`) 


```r
a_variable &lt;- 1
```

The value of the variable can be invoked by simply specifying the **identifier**.


```r
a_variable
```

```
## [1] 1
```



---

## Data frames

**Data frames** are complex data types, which encode the concept of a table

Example: the first five rows of the [`iris`](https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/iris) dataset


```r
iris
```

| Sepal.Length| Sepal.Width| Petal.Length| Petal.Width|Species |
|------------:|-----------:|------------:|-----------:|:-------|
|          5.1|         3.5|          1.4|         0.2|setosa  |
|          4.9|         3.0|          1.4|         0.2|setosa  |
|          4.7|         3.2|          1.3|         0.2|setosa  |
|          4.6|         3.1|          1.5|         0.2|setosa  |
|          5.0|         3.6|          1.4|         0.2|setosa  |

&lt;br/&gt;

... more on what data frames actually are in the coming weeks.


---

## Algorithms and functions

&lt;br/&gt;

*An* **algorithm** *or effective procedure is a mechanical rule, or automatic method, or programme for performing some mathematical operation* (Cutland, 1980).

A **program** is a specific set of instructions that implement an abstract algorithm.

The definition of an algorithm (and thus a program) can consist of one or more **function**s

- set of instructions that perform a task 
- possibly using an input, possibly returning an output value

Programming languages usually provide pre-defined functions that implement common algorithms (e.g., to find the square root of a number or to calculate a linear regression)



---

## Functions

&lt;br/&gt;

Functions execute complex operations and can be invoked 

- specifying the *function name*
- the *arguments* (input values) between simple brackets
    - each *argument* corresponds to a *parameter*
    - sometimes the *parameter* name must be specified


```r
sqrt(2)
```

```
## [1] 1.414214
```

```r
round(1.414214, digits = 2)
```

```
## [1] 1.41
```



---

## Example: data visualisation

&lt;br/&gt;

`R` provides a wide range of functions

- allowing to execute the steps necessary to conduct a data analysis
- e.g., using `hist` to plot the histogram of petal lengths of flowers in `iris`


```r
hist(iris$Petal.Length, main = "Petal lengths")
```

![](101-slides-introduction_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;



---

## Functions and variables

&lt;br/&gt;

- functions can be used on the right side of `&lt;-` 
- variables and functions can be used as *arguments*


```r
sqrt_of_two &lt;- sqrt(2)
sqrt_of_two
```

```
## [1] 1.414214
```

```r
round(sqrt_of_two, digits = 2)
```

```
## [1] 1.41
```

```r
round(sqrt(2), digits = 2)
```

```
## [1] 1.41
```



---

## Coding style


.pull-left[

**Naming**: when creating an identifier for a variable or function

- R is a **case sensitive** language
    - UPPER and lower case are not the same
    - `a_variable` is different from `a_VARIABLE`
- names can include
    -  alphanumeric symbols
    - `.` and `_`
- names must start with
    - a letter

]
.pull-right[

A *coding style* is a way of writing the code, including

- how variables and functions are named
    - lower case and `_`
- how spaces are used in the code
- which libraries are used


```r
# Bad
X&lt;-round(sqrt(2),2)

#Good
sqrt_of_two &lt;- sqrt(2) %&gt;%
 round(digits = 2)
```

Study the [Tidyverse Style Guide](http://style.tidyverse.org/) and use it consistently!

]


---

## Libraries

&lt;br/&gt;

Once a number of related, reusable functions are created

- they can be collected and stored in **libraries** (a.k.a. *packages*)
  - `install.packages` is a function that can be used to install libraries (i.e., downloads it on your computer)
  - `library` is a function that *loads* a library (i.e., makes it available to a script)

Libraries can be of any size and complexity, e.g.:

- `base`: base R functions, including the `sqrt` function above
- `rgdal`: implementation of the [GDAL (Geospatial Data Abstraction Library)](https://gdal.org/) functionalities



---

## Tidyverse

&lt;br/&gt;

.pull-left[

The [Tidyverse](https://www.tidyverse.org/) was introduced by statistician [Hadley Wickham](https://t.co/DWqWlxbOKK?amp=1), Chief Scientist at [RStudio](https://rstudio.com/) (worth following him on [twitter](https://twitter.com/hadleywickham)).

- *"The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures."* ([Tidyverse homepage](https://www.tidyverse.org/)).


]
.pull-right[

**Core libraries**

- [`tibble`](https://tibble.tidyverse.org/)
- [`tidyr`](https://tidyr.tidyverse.org/)
- [`stringr`](https://stringr.tidyverse.org/)
- [`dplyr`](https://dplyr.tidyverse.org/)
- [`readr`](https://readr.tidyverse.org/)
- [`ggplot2`](https://ggplot2.tidyverse.org/)
- [`purrr`](https://purrr.tidyverse.org/)
- [`forcats`](https://forcats.tidyverse.org/)


]

Also, imports [`magrittr`](https://magrittr.tidyverse.org/), which plays an important role.


&lt;!--

## Tidyverse core libraries

The meta-library [Tidyverse](https://www.tidyverse.org/) includes:

- **[`tibble`](https://tibble.tidyverse.org/)** is a modern re-imagining of the data frame, keeping what time has proven to be effective, and throwing out what it has not. Tibbles are data.frames that are lazy and surly: they do less and complain more forcing you to confront problems earlier, typically leading to cleaner, more expressive code. 
- **[`tidyr`](https://tidyr.tidyverse.org/)** provides a set of functions that help you get to tidy data. Tidy data is data with a consistent form: in brief, every variable goes in a column, and every column is a variable.
- **[`stringr`](https://stringr.tidyverse.org/)** provides a cohesive set of functions designed to make working with strings as easy as possible. It is built on top of stringi, which uses the ICU C library to provide fast, correct implementations of common string manipulations. 


## Tidyverse core libraries

The meta-library [Tidyverse](https://www.tidyverse.org/) includes:

- **[`dplyr`](https://dplyr.tidyverse.org/)** provides a grammar of data manipulation, providing a consistent set of verbs that solve the most common data manipulation challenges. 
- **[`readr`](https://readr.tidyverse.org/)** provides a fast and friendly way to read rectangular data (like csv, tsv, and fwf). It is designed to flexibly parse many types of data found in the wild, while still cleanly failing when data unexpectedly changes. 
- **[`ggplot2`](https://ggplot2.tidyverse.org/)** is a system for declaratively creating graphics, based on The Grammar of Graphics. You provide the data, tell ggplot2 how to map variables to aesthetics, what graphical primitives to use, and it takes care of the details.



## Tidyverse core libraries

The meta-library [Tidyverse](https://www.tidyverse.org/) contains the following libraries:

- **[`purrr`](https://purrr.tidyverse.org/)** enhances Râs functional programming (FP) toolkit by providing a complete and consistent set of tools for working with functions and vectors. Once you master the basic concepts, purrr allows you to replace many for loops with code that is easier to write and more expressive. 
- **[`forcats`](https://forcats.tidyverse.org/)** provides a suite of useful tools that solve common problems with factors. R uses factors to handle categorical variables, variables that have a fixed and known set of possible values.

--&gt;



---

## The pipe operator

The [Tidyverse](https://www.tidyverse.org/) (via [`magrittr`](https://magrittr.tidyverse.org/)) also provide a clean and effective way of combining multiple manipulation steps

.pull-left-small[

The pipe operator `%&gt;%`

- takes the result from one function
- and passes it to the next function
- as the **first argument**
- that doesn't need to be included in the code anymore

]
.pull-right-large[

![Pipe operator example and diagram](images/PipeOperator.png)

]


---

## Pipe example

&lt;br/&gt;

The two codes below are equivalent

- the first simply invokes the functions
- the second uses the pipe operator `%&gt;%`


```r
round(sqrt(2), digits = 2)
```

```
## [1] 1.41
```


```r
library(tidyverse)

sqrt(2) %&gt;%
 round(digits = 2)
```

```
## [1] 1.41
```


---

## Pipe example: data visualisation

&lt;br/&gt;

The previous histogram example


```r
hist(iris$Petal.Length, main = "Petal lengths")
```

can be rewritten as


```r
iris %&gt;% pull(Petal.Length) %&gt;% hist(main = "Petal lengths")
```

![](101-slides-introduction_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;


---

## Summary

&lt;br/&gt;

.pull-left[

An introduction to R

- The language
- Core concepts
- Tidyverse

**Next week**: Reproducible data science

- Read and write data
- Select and filter
- Reproducibility

&lt;br/&gt;

.referencenote[
Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan). The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](https://yihui.org/knitr), and [R Markdown](https://rmarkdown.rstudio.com).
]

]
.pull-right[

![](https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/R_logo.svg/1200px-R_logo.svg.png)

.right[
.referencenote[
by Hadley Wickham and others at RStudio&lt;br/&gt;
via Wikimedia Commons, CC BY-SA 4.0
]
]

]



    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros/my_remark_macros.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
