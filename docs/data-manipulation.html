<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Data manipulation | R for Geographic Data Science</title>
<meta name="author" content="Stefano De Sabbata">
<meta name="description" content="Print this chapter  3.1 R workflow  3.1.1 R Projects RStudio provides an extremely useful functionality to organise all your code and data, that is R Projects. Those are specialised files that...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 3 Data manipulation | R for Geographic Data Science">
<meta property="og:type" content="book">
<meta property="og:url" content="https://sdesabbata.github.io/r-for-geographic-data-science/data-manipulation.html">
<meta property="og:image" content="https://sdesabbata.github.io/r-for-geographic-data-science/images/r-for-geographic-data-science-cover.png">
<meta property="og:description" content="Print this chapter  3.1 R workflow  3.1.1 R Projects RStudio provides an extremely useful functionality to organise all your code and data, that is R Projects. Those are specialised files that...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Data manipulation | R for Geographic Data Science">
<meta name="twitter:description" content="Print this chapter  3.1 R workflow  3.1.1 R Projects RStudio provides an extremely useful functionality to organise all your code and data, that is R Projects. Those are specialised files that...">
<meta name="twitter:image" content="https://sdesabbata.github.io/r-for-geographic-data-science/images/r-for-geographic-data-science-cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2Y0M0936JL"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-2Y0M0936JL');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Geographic Data Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Getting started</li>
<li><a class="" href="introduction-to-r.html"><span class="header-section-number">1</span> Introduction to R</a></li>
<li><a class="" href="reproducible-data-science.html"><span class="header-section-number">2</span> Reproducible data science</a></li>
<li><a class="active" href="data-manipulation.html"><span class="header-section-number">3</span> Data manipulation</a></li>
<li><a class="" href="table-operations.html"><span class="header-section-number">4</span> Table operations</a></li>
<li class="book-part">Data analysis</li>
<li><a class="" href="exploratory-visualisation.html"><span class="header-section-number">5</span> Exploratory visualisation</a></li>
<li><a class="" href="exploratory-statistics.html"><span class="header-section-number">6</span> Exploratory statistics</a></li>
<li><a class="" href="comparing-data.html"><span class="header-section-number">7</span> Comparing data</a></li>
<li><a class="" href="regression-analysis.html"><span class="header-section-number">8</span> Regression analysis</a></li>
<li class="book-part">Machine learning</li>
<li><a class="" href="supervised-machine-learning.html"><span class="header-section-number">9</span> Supervised machine learning</a></li>
<li><a class="" href="unsupervised-machine-learning.html"><span class="header-section-number">10</span> Unsupervised machine learning</a></li>
<li class="book-part">R scripting</li>
<li><a class="" href="control-structures.html"><span class="header-section-number">11</span> Control structures</a></li>
<li><a class="" href="working-with-functions.html"><span class="header-section-number">12</span> Working with functions</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="appendix-1.html">Appendix 1</a></li>
<li><a class="" href="solutions.html">Solutions</a></li>
<li><a class="" href="lecture-slides.html">Lecture slides</a></li>
<li><a class="" href="reading-list.html">Reading list</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/sdesabbata/r-for-geographic-data-science">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data-manipulation" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Data manipulation<a class="anchor" aria-label="anchor" href="#data-manipulation"><i class="fas fa-link"></i></a>
</h1>
<p><br><small><a href="javascript:if(window.print)window.print()">Print this chapter</a></small></p>
<div id="r-workflow" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> R workflow<a class="anchor" aria-label="anchor" href="#r-workflow"><i class="fas fa-link"></i></a>
</h2>
<div id="r-projects" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> R Projects<a class="anchor" aria-label="anchor" href="#r-projects"><i class="fas fa-link"></i></a>
</h3>
<p>RStudio provides an extremely useful functionality to organise all your code and data, that is <strong>R Projects</strong>. Those are specialised files that RStudio can use to store all the information it has on a specific project that you are working on – <em>Environment</em>, <em>History</em>, working directory, and much more, as we will see in the coming weeks.</p>
<p>In RStudio Server, in the <em>Files</em> tab of the bottom-left panel, click on <em>Home</em> to make sure you are in your home folder – if you are working on your own computer, create a folder for these practicals wherever most convenient. Click on <em>New Folder</em> and enter <em>Practicals</em> in the prompt dialogue to create a folder named <em>Practicals</em>.</p>
<p>Select <em>File &gt; New Project …</em> from the main menu, then from the prompt menu, <em>New Directory</em>, and then <em>New Project</em>. Insert <em>Practical_103_example</em> as the directory name, and select the <em>Practicals</em> folder for the field <em>Create project as subdirectory of</em>. Finally, click <em>Create Project</em>.</p>
<p>RStudio has now created the project, and it should have activated it. If that is the case, the <em>Files</em> tab in the bottom-right panel should be in the <em>Practical_103_example</em> folder, which contains only the <em>Practical_103_example.Rproj</em> file. The <em>Practical_103_example.Rproj</em> stores all the <em>Environment</em> information for the current project, and all the project files (e.g., R scripts, data, output files) should be stored within the <em>Practical_103_example</em> folder. Moreover, the <em>Practical_103_example</em> is now your working directory, which means that you can refer to a file in the folder by using only its name and if you save a file, that is the default directory where to save it.</p>
<p>On the top-right corner of RStudio, you should see a blue icon representing an R in a cube next to the name of the project (<em>Practical_103_example</em>). That also indicates that you are within the <em>Practical_103_example</em> project. Click on <em>Practical_103_example</em> and select <em>Close Project</em> to close the project. Next to the R in a cube icon, you should now see <em>Project: (None)</em>. Click on <em>Project: (None)</em> and select <em>Practical_103_example</em> from the list to reactivate the <em>Practical_103_example</em> project. In the future, you will thus be able to close and reactivate this or any other project as necessary, depending on what you are working with. Projects can also be activated by clicking on the related <code>.Rproj</code> file in the <em>Files</em> tab in the bottom-right panel or through the <em>Open Project…</em> option in the file menu.</p>
<p>With the <em>Practical_103_example</em> project activated, select from the top menu <em>File &gt; New File &gt; RMarkdown</em> to create a new RMarkdown document – you can use the default options in the creation menu, as this is just an example. Save and <em>knit</em> the RMarkdown document (<a href="reproducible-data-science.html#rmarkdown">as shown in the previous chapter</a>). As you can see, both the RMarkdown file and the knitted are saved within the <em>Practical_103_example</em> folder.</p>
</div>
</div>
<div id="data-2011-census-and-oac" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Data: 2011 Census and OAC<a class="anchor" aria-label="anchor" href="#data-2011-census-and-oac"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="https://github.com/geogale/2011OAC">2011 Output Area Classification</a> (2011 OAC) is a geodemographic classification of the census Output Areas (OA) of the UK, which was created by <a href="http://josis.org/index.php/josis/article/viewArticle/232">Gale et al. (2016)</a> starting from an initial set of 167 prospective variables from the United Kingdom Census 2011: 86 were removed, 41 were retained as they are, and 40 were combined, leading to a final set of 60 variables. <a href="http://josis.org/index.php/josis/article/viewArticle/232">Gale et al. (2016)</a> finally used the k-means clustering approach to create 8 clusters or supergroups (see <a href="https://oac.datashine.org.uk">map at datashine.org.uk</a>), as well as 26 groups and 76 subgroups. The dataset in the file <code>2011_OAC_Raw_uVariables_Leicester.csv</code> contains all the original 167 variables, as well as the resulting groups, for the city of Leicester.</p>
<p>Before continuing with the remainder of the practical, create a new project named <em>Leicester_population</em> and make sure it is activated. Download from Blackboard (or see the <a href="https://github.com/sdesabbata/granolarr/tree/master/data">data</a> folder of the repository) the <code>2011_OAC_Raw_uVariables_Leicester.csv</code> file on your computer. The full variable names can be found in the file <code>2011_OAC_Raw_uVariables_Lookup.csv</code>.</p>
<p>Create a new RMarkdown document using <em>“Exploring population distribution in Leicester”</em> as the title and <em>PDF</em> as the output file type. Delete the example code after the <code>setup</code> chunk. Add a new markdown second-heading section named <em>Libraries</em> and a chunk loading the <code>tidyverse</code> and <code>knitr</code> libraries (see below). Save the file with the name <code>exploring_Leicester_population.Rmd</code> in the <em>Leicester_population</em> project.</p>
<pre><code>---
title: "Exploring population distribution in Leicester"
output: pdf_document
date: "2022-10-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Libraries

```{r libraries, warning=FALSE, message=FALSE}
library(tidyverse)
library(knitr)
```
</code></pre>
<p>Upload the <code>2011_OAC_Raw_uVariables_Leicester.csv</code> file to the <em>Leicester_population</em> folder by clicking the <em>Upload</em> button and selecting the file from your computer.</p>
<p><strong>Important</strong>: at the time of writing, Chrome seems to upload the file correctly, whereas it might be necessary to change the names of the files after uploading using Microsoft Edge. If you are using Microsoft Edge, make sure the uploaded filename is <code>2011_OAC_Raw_uVariables_Leicester.csv</code> with not additional text. Otherwise, select the tick next to the file in the <em>File</em> tab in the bottom-right panel, click <em>Rename</em> (on the panel’s bar) and rename the file to <code>2011_OAC_Raw_uVariables_Leicester.csv</code>.</p>
</div>
<div id="read-and-write-data" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Read and write data<a class="anchor" aria-label="anchor" href="#read-and-write-data"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="https://readr.tidyverse.org/index.html"><code>readr</code> library</a> (also part of the Tidyverse) provides a series of functions that can be used to load from and save data to different file formats.</p>
<p>The <code>read_csv</code> function reads a <em>Comma Separated Values (CSV)</em> file from the path provided as the first argument. The code below loads the 2011 OAC dataset. The <code>read_csv</code> instruction throws a warning that shows the assumptions about the data types used when loading the data. As illustrated by the output of the last line of code, the data are loaded as a tibble 969 x 190, that is 969 rows – one for each OA – and 190 columns, 167 of which represent the input variables used to create the 2011 OAC.</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the Leicester 2011 OAC dataset from the csv file</span></span>
<span><span class="va">leicester_2011OAC</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"2011_OAC_Raw_uVariables_Leicester.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Illustrate some of the contents</span></span>
<span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">OA11CD</span>, <span class="va">LSOA11CD</span>, </span>
<span>    <span class="va">supgrpcode</span>, <span class="va">supgrpname</span>,</span>
<span>    <span class="va">Total_Population</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="13%">
<col width="13%">
<col width="14%">
<col width="36%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="left">OA11CD</th>
<th align="left">LSOA11CD</th>
<th align="right">supgrpcode</th>
<th align="left">supgrpname</th>
<th align="right">Total_Population</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E00069517</td>
<td align="left">E01013785</td>
<td align="right">6</td>
<td align="left">Suburbanites</td>
<td align="right">313</td>
</tr>
<tr class="even">
<td align="left">E00069514</td>
<td align="left">E01013784</td>
<td align="right">2</td>
<td align="left">Cosmopolitans</td>
<td align="right">323</td>
</tr>
<tr class="odd">
<td align="left">E00169516</td>
<td align="left">E01013713</td>
<td align="right">4</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">341</td>
</tr>
</tbody>
</table></div>
<p>The function <code>write_csv</code> can be used to save a dataset as a <code>csv</code> file. For instance, the code below uses <code>tidyverse</code> functions and the pipe operator <code>%&gt;%</code> to <em>reproduce</em> the <code>2011_OAC_supgrp_Leicester.csv</code> dataset used <a href="slides/103-slides-data-manipulation.html">in the lecture</a>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>read</strong> the 2011 OAC file <code>2011_OAC_Raw_uVariables_Leicester.csv</code> directly from the file, but without storing it into a variable;</li>
<li>
<strong>select</strong> the OA code variable <code>OA11CD</code>, and the two variables representing the code and name of the supergroup assigned to each OA by the 2011 OAC (<code>supgrpcode</code> and <code>supgrpname</code> respectively);</li>
<li>
<strong>filter</strong> only those OA in the supergroup <em>Suburbanites</em> (code <code>6</code>);</li>
<li>
<strong>write</strong> the results to a file named <code>my--2011_OAC_supgrp_Leicester.csv</code>, which is your own version of the <code>2011_OAC_supgrp_Leicester.csv</code>.</li>
</ol>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"2011_OAC_Raw_uVariables_Leicester.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">OA11CD</span>, <span class="va">LSOA11CD</span>, </span>
<span>    <span class="va">supgrpcode</span>, <span class="va">supgrpname</span>,</span>
<span>    <span class="va">Total_Population</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="st">"my--2011_OAC_supgrp_Leicester.csv"</span><span class="op">)</span></span></code></pre></div>
<div id="file-paths" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> File paths<a class="anchor" aria-label="anchor" href="#file-paths"><i class="fas fa-link"></i></a>
</h3>
<p>File paths can be specified in two different ways:</p>
<ul>
<li>
<strong>Absolute file path</strong>: the full file path from the <em>root</em> folder of your computer to the file.
<ul>
<li>The absolute file path of a file can be obtained using the <code><a href="https://rdrr.io/r/base/file.choose.html">file.choose()</a></code> instruction from the <em>R Console</em>, which will open an interactive window that will allow you to select a file from your computer. The absolute path to that file will be printed to the console.</li>
<li>Absolute file paths provide a direct link to a specific file and ensure that you are loading that exact file.</li>
<li>However, absolute file paths can be problematic if the file is moved or if the script is run on a different system, and the file path would then be invalid</li>
</ul>
</li>
<li>
<strong>Relative file path</strong>: a partial path from the current working folder to the file.
<ul>
<li>The current <em>working directory</em> (current folder) is part of the environment of the <code>R</code> session and can be identified using the <code><a href="https://rdrr.io/r/base/getwd.html">getwd()</a></code> instruction from the <em>`</em>R Console*.
<ul>
<li>When a new R session is started, the current <em>working directory</em> is usually the computer user’s home folder.</li>
<li>When working within an R project, the current <em>working directory</em> is the project directory.</li>
<li>The current working can be manually set to a specific directory using the function <code>setwd</code>.</li>
</ul>
</li>
<li>Using a relative path while working within an R project is the option that provides the best overall <strong>consistency</strong>, assuming that all (data) files to be read by scripts of a project are also contained in the project folder (or subfolder).</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Absolute file path</span></span>
<span><span class="co"># Note: the first / indicates the root folder</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"/home/username/GY7702/data/2011_OAC_Raw_uVariables_Leicester.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Relative file path</span></span>
<span><span class="co"># assuming the working directory is the user's home folder</span></span>
<span><span class="co"># /home/username</span></span>
<span><span class="co"># Note: no initial / for relative file paths</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"GY7702/data/2011_OAC_Raw_uVariables_Leicester.csv"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Relative file path</span></span>
<span><span class="co"># assuming you are working within an R project created in the folder</span></span>
<span><span class="co"># /home/username/GY7702</span></span>
<span><span class="co"># Note: no initial / for relative file paths</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/2011_OAC_Raw_uVariables_Leicester.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="data-manipulation-1" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Data manipulation<a class="anchor" aria-label="anchor" href="#data-manipulation-1"><i class="fas fa-link"></i></a>
</h2>
<p>The analysis below uses the <a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> library (also part of the Tidyverse), which it offers a grammar for data manipulation.</p>
<p>For instance, the function <code>count</code> can be used to count the number of rows in a data frame. The code below provides the <code>leicester_2011OAC</code> dataframe (as read in input in the section above) as input to the function <code>count</code> through the pipe operator, thus creating a new <a href="https://tibble.tidyverse.org/"><code>tibble</code></a> with only one row and one column, containing the number of rows in that dataframe – that is, the number of OAs in Leicester.</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">n</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">969</td>
</tr></tbody>
</table></div>
<p>As discussed in the previous lecture, a <a href="https://tibble.tidyverse.org/"><code>tibble</code></a> is a data type similar to data frames, used by all the Tidyverse libraries. All Tidyverse functions output <code>tibble</code> rather than <code>data.frame</code> objects when representing a table. However, <code>data.frame</code> object can be provided as input, as they are automatically converted by Tidyverse functions before proceeding with the processing steps.</p>
<p>The example above already shows how the <strong>pipe operator</strong> can be used effectively in a multi-step operation. In the <code>tibble</code> outputted by the <code>count</code> function above, the column <code>n</code> provides the count. The function <code>kable</code> of the library <code>knitr</code> is used to produce a well-formatted table.</p>
<p>Note how the code above goes to a new line after every <code>%&gt;%</code>, and space is added at the beginning of new lines. That is very common in R programming (especially when functions have many parameters) as it makes the code more readable.</p>
<div id="summarise" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Summarise<a class="anchor" aria-label="anchor" href="#summarise"><i class="fas fa-link"></i></a>
</h3>
<p>The verb <code>count</code> is a special case (a shorthand) of the more general verb <code>summarise</code> (<code>summarize</code> using the American English spelling is also available with the same functionality), which allows generating tables presenting aggregate values of input data.</p>
<p>For instance, <code>summarise</code> can be used to create a table containing:</p>
<ul>
<li>a column presenting the total population of Leicester;</li>
<li>a column presenting the total number of OAs in Leicester;</li>
<li>a column presenting the average population per OAs in Leicester;</li>
<li>a column presenting a logical value stating whether any OA in Leicester contains more than 600 people.</li>
</ul>
<p>That can be achieved applying different aggregate functions to the same column (<code>Total_Population</code>) of the <code>leicester_2011OAC</code> as illustrated below.</p>
<ul>
<li>
<code>sum</code> to calculate the total population of Leicester;</li>
<li>
<code>n</code> to count the number of rows (as mentioned above <code>count</code> is a shorthand for the combination of <code>summarise</code> with <code>n</code>);</li>
<li>
<code>mean</code> to calculate the average population per OAs in Leicester;</li>
<li>
<code>any</code> with a conditional statement comparing <code>Total_Population</code> and the value <code>600</code> using the numeric operator <code>&gt;</code> (greater than) to assess whether any OA in Leicester contains more than 600 people.</li>
</ul>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    <span class="co"># Total population in Leicester</span></span>
<span>    tot_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span>,</span>
<span>    <span class="co"># Number of OAs, no input column needed</span></span>
<span>    num_of_OAs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># Average population</span></span>
<span>    avg_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span>, </span>
<span>    <span class="co"># Is there any OA with over 200 people?</span></span>
<span>    pop_over_600 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">Total_Population</span> <span class="op">&gt;</span> <span class="fl">600</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">tot_pop</th>
<th align="right">num_of_OAs</th>
<th align="right">avg_pop</th>
<th align="left">pop_over_600</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">329839</td>
<td align="right">969</td>
<td align="right">340.3911</td>
<td align="left">TRUE</td>
</tr></tbody>
</table></div>
<p>A set of aggregate functions which are frequently used with <code>summarise</code> is available in <a href="https://dplyr.tidyverse.org/reference/summarise.html#useful-functions">the <code>dplyr</code> page on <code>summarise</code></a>.</p>
<p>To carry out more complex aggregations, the function <code>summarise</code> can be used in combination with the function <code>group_by</code> to summarise the values in the data frame based on groups. Rows having the same value for the column specified for the verb <code>group_by</code> (in the example below, the 2011 OAC supergroup, <code>supgrpname</code>) are grouped together, then values are aggregated based on the functions specified for the verb <code>summarise</code> (using one or more columns in the calculation).</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    <span class="co"># Total population in Leicester</span></span>
<span>    tot_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span>,</span>
<span>    <span class="co"># Number of OAs, no input column needed</span></span>
<span>    num_of_OAs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># Average population</span></span>
<span>    avg_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span>, </span>
<span>    <span class="co"># Is there any OA with over 200 people?</span></span>
<span>    pop_over_600 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">Total_Population</span> <span class="op">&gt;</span> <span class="fl">600</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="40%">
<col width="11%">
<col width="15%">
<col width="13%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left">supgrpname</th>
<th align="right">tot_pop</th>
<th align="right">num_of_OAs</th>
<th align="right">avg_pop</th>
<th align="left">pop_over_600</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Constrained City Dwellers</td>
<td align="right">9263</td>
<td align="right">36</td>
<td align="right">257.3056</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">Cosmopolitans</td>
<td align="right">26813</td>
<td align="right">83</td>
<td align="right">323.0482</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity Central</td>
<td align="right">19137</td>
<td align="right">57</td>
<td align="right">335.7368</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">Hard-Pressed Living</td>
<td align="right">32069</td>
<td align="right">101</td>
<td align="right">317.5149</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">Multicultural Metropolitans</td>
<td align="right">205007</td>
<td align="right">573</td>
<td align="right">357.7784</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">Suburbanites</td>
<td align="right">17326</td>
<td align="right">54</td>
<td align="right">320.8519</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">Urbanites</td>
<td align="right">20224</td>
<td align="right">65</td>
<td align="right">311.1385</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table></div>
<p>The shorthand function <code>count</code> also has the option to specify a column that will be used for an internal grouping. In the example below, the column name <code>supgrpname</code> is provided as an argument to the function <code>count</code>. As a result, the output shows the number of rows grouped by 2011 OAC supergroup.</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">supgrpname</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Constrained City Dwellers</td>
<td align="right">36</td>
</tr>
<tr class="even">
<td align="left">Cosmopolitans</td>
<td align="right">83</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity Central</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="left">Hard-Pressed Living</td>
<td align="right">101</td>
</tr>
<tr class="odd">
<td align="left">Multicultural Metropolitans</td>
<td align="right">573</td>
</tr>
<tr class="even">
<td align="left">Suburbanites</td>
<td align="right">54</td>
</tr>
<tr class="odd">
<td align="left">Urbanites</td>
<td align="right">65</td>
</tr>
</tbody>
</table></div>
</div>
<div id="mutate" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Mutate<a class="anchor" aria-label="anchor" href="#mutate"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code>mutate</code> can be used to create a new column by conducting operations on current columns. For instance, in the example below, <code>summarise</code> is first used to calculate the total number of people and the number of OAs per 2011 OAC supergroup. The verb <code>mutate</code> is then used to calculate the average population per OA per 2011 OAC supergroup, recreating the same <code>avg_pop</code> column as above but through a different process.</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    <span class="co"># Total population in Leicester</span></span>
<span>    tot_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span>,</span>
<span>    <span class="co"># Number of OAs, no input column needed</span></span>
<span>    num_of_OAs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># Is there any OA with over 200 people?</span></span>
<span>    pop_over_600 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">Total_Population</span> <span class="op">&gt;</span> <span class="fl">600</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Average population</span></span>
<span>    avg_pop <span class="op">=</span> <span class="va">tot_pop</span> <span class="op">/</span> <span class="va">num_of_OAs</span>, </span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="41%">
<col width="11%">
<col width="16%">
<col width="19%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">supgrpname</th>
<th align="right">tot_pop</th>
<th align="right">num_of_OAs</th>
<th align="left">pop_over_600</th>
<th align="right">avg_pop</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Constrained City Dwellers</td>
<td align="right">9263</td>
<td align="right">36</td>
<td align="left">FALSE</td>
<td align="right">257.31</td>
</tr>
<tr class="even">
<td align="left">Cosmopolitans</td>
<td align="right">26813</td>
<td align="right">83</td>
<td align="left">TRUE</td>
<td align="right">323.05</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity Central</td>
<td align="right">19137</td>
<td align="right">57</td>
<td align="left">FALSE</td>
<td align="right">335.74</td>
</tr>
<tr class="even">
<td align="left">Hard-Pressed Living</td>
<td align="right">32069</td>
<td align="right">101</td>
<td align="left">FALSE</td>
<td align="right">317.51</td>
</tr>
<tr class="odd">
<td align="left">Multicultural Metropolitans</td>
<td align="right">205007</td>
<td align="right">573</td>
<td align="left">TRUE</td>
<td align="right">357.78</td>
</tr>
<tr class="even">
<td align="left">Suburbanites</td>
<td align="right">17326</td>
<td align="right">54</td>
<td align="left">FALSE</td>
<td align="right">320.85</td>
</tr>
<tr class="odd">
<td align="left">Urbanites</td>
<td align="right">20224</td>
<td align="right">65</td>
<td align="left">FALSE</td>
<td align="right">311.14</td>
</tr>
</tbody>
</table></div>
<p>In this second example, the <code>u005</code> column (which represents the area of the OA in <a href="https://en.wikipedia.org/wiki/Hectare">hectares</a>, see <code>2011_OAC_Raw_uVariables_Lookup.csv</code>) is used to calculate the population density for each OA.</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Population density</span></span>
<span>    pop_density <span class="op">=</span> <span class="va">Total_Population</span> <span class="op">/</span> <span class="va">u005</span>, </span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">pop_density</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">OA11CD</th>
<th align="right">pop_density</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E00069517</td>
<td align="right">33.69</td>
</tr>
<tr class="even">
<td align="left">E00069514</td>
<td align="right">131.30</td>
</tr>
<tr class="odd">
<td align="left">E00169516</td>
<td align="right">240.14</td>
</tr>
<tr class="even">
<td align="left">E00169048</td>
<td align="right">104.23</td>
</tr>
<tr class="odd">
<td align="left">E00169044</td>
<td align="right">99.08</td>
</tr>
<tr class="even">
<td align="left">E00069041</td>
<td align="right">51.31</td>
</tr>
<tr class="odd">
<td align="left">E00169049</td>
<td align="right">42.53</td>
</tr>
<tr class="even">
<td align="left">E00068806</td>
<td align="right">57.78</td>
</tr>
<tr class="odd">
<td align="left">E00068886</td>
<td align="right">122.87</td>
</tr>
<tr class="even">
<td align="left">E00068807</td>
<td align="right">76.21</td>
</tr>
</tbody>
</table></div>
</div>
<div id="arrange" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Arrange<a class="anchor" aria-label="anchor" href="#arrange"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code>arrange</code> can be used to sort a tibble by ascending order of the values in the specified column. If the operator <code>-</code> is specified before the column name, the descending order is used. The code below would produce a table showing the ten OAs with the largest population in Leicester.</p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">OA11CD</span>, <span class="va">supgrpname</span>, </span>
<span>    <span class="va">Total_Population</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span></span>
<span>    <span class="co"># Descending delay</span></span>
<span>    <span class="op">-</span><span class="va">Total_Population</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>In the example above, we have used <code>slice_head</code> to present only the first <code>n</code> (in the example <code>10</code>) rows in a table based on the existing order. The <code>dplyr</code> library also provides the functions <code>slice_max</code> and <code>slice_min</code> which incorporate the sorting functionality (see <a href="https://dplyr.tidyverse.org/reference/slice.html"><code>slice</code> reference page</a>).</p>
<p>As such, the following code uses <code>slice_max</code> to produce a table including only the 10 OAs with the <em>highest</em> population.</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">OA11CD</span>, <span class="va">supgrpname</span>, </span>
<span>    <span class="va">Total_Population</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span></span>
<span>    <span class="va">Total_Population</span>, </span>
<span>    n <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">OA11CD</th>
<th align="left">supgrpname</th>
<th align="right">Total_Population</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E00169553</td>
<td align="left">Cosmopolitans</td>
<td align="right">714</td>
</tr>
<tr class="even">
<td align="left">E00168096</td>
<td align="left">Cosmopolitans</td>
<td align="right">708</td>
</tr>
<tr class="odd">
<td align="left">E00069303</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">623</td>
</tr>
<tr class="even">
<td align="left">E00169458</td>
<td align="left">Cosmopolitans</td>
<td align="right">622</td>
</tr>
<tr class="odd">
<td align="left">E00069304</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">608</td>
</tr>
<tr class="even">
<td align="left">E00169575</td>
<td align="left">Cosmopolitans</td>
<td align="right">597</td>
</tr>
<tr class="odd">
<td align="left">E00069393</td>
<td align="left">Ethnicity Central</td>
<td align="right">591</td>
</tr>
<tr class="even">
<td align="left">E00169564</td>
<td align="left">Cosmopolitans</td>
<td align="right">591</td>
</tr>
<tr class="odd">
<td align="left">E00069482</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">590</td>
</tr>
<tr class="even">
<td align="left">E00069216</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">586</td>
</tr>
<tr class="odd">
<td align="left">E00169446</td>
<td align="left">Cosmopolitans</td>
<td align="right">586</td>
</tr>
<tr class="even">
<td align="left">E00069439</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">586</td>
</tr>
</tbody>
</table></div>
<p>The following code, instead, uses <code>slice_min</code>, thus producing a table including only the 10 OAs with the <em>lowest</em> population..</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">OA11CD</span>, <span class="va">supgrpname</span>, </span>
<span>    <span class="va">Total_Population</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min</a></span><span class="op">(</span></span>
<span>    <span class="va">Total_Population</span>, </span>
<span>    n <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">OA11CD</th>
<th align="left">supgrpname</th>
<th align="right">Total_Population</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E00169530</td>
<td align="left">Ethnicity Central</td>
<td align="right">103</td>
</tr>
<tr class="even">
<td align="left">E00169528</td>
<td align="left">Ethnicity Central</td>
<td align="right">119</td>
</tr>
<tr class="odd">
<td align="left">E00069382</td>
<td align="left">Ethnicity Central</td>
<td align="right">126</td>
</tr>
<tr class="even">
<td align="left">E00069149</td>
<td align="left">Cosmopolitans</td>
<td align="right">131</td>
</tr>
<tr class="odd">
<td align="left">E00069332</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">132</td>
</tr>
<tr class="even">
<td align="left">E00168107</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">133</td>
</tr>
<tr class="odd">
<td align="left">E00168094</td>
<td align="left">Cosmopolitans</td>
<td align="right">141</td>
</tr>
<tr class="even">
<td align="left">E00169486</td>
<td align="left">Cosmopolitans</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="left">E00069184</td>
<td align="left">Urbanites</td>
<td align="right">158</td>
</tr>
<tr class="even">
<td align="left">E00169472</td>
<td align="left">Constrained City Dwellers</td>
<td align="right">160</td>
</tr>
</tbody>
</table></div>
<p>In both cases, if the table contains ties, all rows containing a value that is present among the maximum or minimum selected values are presented, as is the case with the rows containing the value <code>21</code> in the example above.</p>
</div>
<div id="data-manipulation-example" class="section level3" number="3.4.4">
<h3>
<span class="header-section-number">3.4.4</span> Data manipulation example<a class="anchor" aria-label="anchor" href="#data-manipulation-example"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, the code below illustrates a more complex, multi-step operation using all the functions discussed above. This is a full example of a short analysis using only one series of pipes to read, process and write data using <code>R</code> and almost all the <code>tidyverse</code> <em>verbs</em> seen so far.</p>
<p>The input data are read from the csv file and part of the data are selected and filtered. The data are grouped, aggregated and arranged in order. The percentage of people living in OAs assigned to each 2011 OAC supergroup is calculated. The <a href="https://magrittr.tidyverse.org/reference/tee.html">Tee pipe</a> (from the <code>magrittr</code> library) is used to write the resulting table to a file, while also passing the same input to the subsequent <code>kable</code> function to display the data.</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's start from the filename</span></span>
<span><span class="st">"2011_OAC_supgrp_Leicester.csv"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># as input to the read_csv function</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>col_types <span class="op">=</span> <span class="st">"cccci"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Select only the necessary columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">supgrpname</span>,    <span class="va">Total_Population</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Let's say we are not interested in</span></span>
<span>  <span class="co"># the Suburbanites supergroup</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op">!=</span> <span class="st">"Suburbanites"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Group by supergroup</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Aggregate population</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>tot_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Ungroup</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Arrange by descending total population</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">tot_pop</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Calculate percentage</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>perc_pop <span class="op">=</span> <span class="op">(</span><span class="va">tot_pop</span> <span class="op">/</span> <span class="fl">329839</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html">%T&gt;%</a></span></span>
<span>  <span class="co"># Then use the Tee pipe %T&gt;% in the line above</span></span>
<span>  <span class="co"># to write the calculated values to file</span></span>
<span>  <span class="co"># and pass the same input values to the kable function</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span></span>
<span>    <span class="st">"2011_Leicester_pop_per_OAC_supgrp_excl_suburb.csv"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Print to screen nicely</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">supgrpname</th>
<th align="right">tot_pop</th>
<th align="right">perc_pop</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Multicultural Metropolitans</td>
<td align="right">205007</td>
<td align="right">62.15</td>
</tr>
<tr class="even">
<td align="left">Hard-Pressed Living</td>
<td align="right">32069</td>
<td align="right">9.72</td>
</tr>
<tr class="odd">
<td align="left">Cosmopolitans</td>
<td align="right">26813</td>
<td align="right">8.13</td>
</tr>
<tr class="even">
<td align="left">Urbanites</td>
<td align="right">20224</td>
<td align="right">6.13</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity Central</td>
<td align="right">19137</td>
<td align="right">5.80</td>
</tr>
<tr class="even">
<td align="left">Constrained City Dwellers</td>
<td align="right">9263</td>
<td align="right">2.81</td>
</tr>
</tbody>
</table></div>
</div>
<div id="componentization" class="section level3" number="3.4.5">
<h3>
<span class="header-section-number">3.4.5</span> Componentization<a class="anchor" aria-label="anchor" href="#componentization"><i class="fas fa-link"></i></a>
</h3>
<p>It is important to note that in the example above, no information is stored in the local environment. The input is read directly from the computer storage, the whole process is conducted in the <code>R</code> internal memory, and the output is saved back to the computer storage. That is the whole purpose of the pipe operator: to avoid creating unnecessary and temporary “mid-products” during the computation (i.e., variables whose only purpose is to store the data before the next step).</p>
<p>However, it is frequently useful to split the processing into different steps, which allow the data to be inspected mid-way through the analysis or for the data to be used twice in two subsequent steps. Finding a good balance between too long and too short pipe sequences and too many or too few “mid-products” is the programmer’s task – and something that can only be learnt by experience and observing good examples of code.</p>
<p>The following example showcases how the process above can be subdivided into five meaningful steps.</p>
<ol style="list-style-type: decimal">
<li>Read the data. This is frequently done as a separate step, as some datasets might require significant time to be read from computer storage, and it is frequently best to read them only once.</li>
<li>Calculate the total population per 2011 OAC supergroup, excluding the suburban population. This is a significant transformation of the original data, which might be worth saving and inspecting.</li>
<li>Update the new table using mutate and the <a href="https://magrittr.tidyverse.org/reference/compound.html">assignment pipe operator <code>%&lt;&gt;%</code></a> (from the <code>magrittr</code> library).</li>
<li>Print the result.</li>
<li>Save the result to the computer storage.</li>
</ol>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op">&lt;-</span></span>
<span>  <span class="co"># Let's start from the filename</span></span>
<span>  <span class="st">"2011_OAC_supgrp_Leicester.csv"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># as input to the read_csv function</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>col_types <span class="op">=</span> <span class="st">"cccci"</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_nonsuburb_pop</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Select only the necessary columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">supgrpname</span>,    <span class="va">Total_Population</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Let's say we are not interested in</span></span>
<span>  <span class="co"># the Suburbanites supergroup</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op">!=</span> <span class="st">"Suburbanites"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Group by supergroup</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Aggregate population</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>tot_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Ungroup</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Arrange by descending total population</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">tot_pop</span><span class="op">)</span></span>
<span></span>
<span><span class="va">leicester_nonsuburb_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html">%&lt;&gt;%</a></span></span>
<span>  <span class="co"># Calculate percentage</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>perc_pop <span class="op">=</span> <span class="op">(</span><span class="va">tot_pop</span> <span class="op">/</span> <span class="fl">329839</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_nonsuburb_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Print to screen nicely</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">supgrpname</th>
<th align="right">tot_pop</th>
<th align="right">perc_pop</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Multicultural Metropolitans</td>
<td align="right">205007</td>
<td align="right">62.15</td>
</tr>
<tr class="even">
<td align="left">Hard-Pressed Living</td>
<td align="right">32069</td>
<td align="right">9.72</td>
</tr>
<tr class="odd">
<td align="left">Cosmopolitans</td>
<td align="right">26813</td>
<td align="right">8.13</td>
</tr>
<tr class="even">
<td align="left">Urbanites</td>
<td align="right">20224</td>
<td align="right">6.13</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity Central</td>
<td align="right">19137</td>
<td align="right">5.80</td>
</tr>
<tr class="even">
<td align="left">Constrained City Dwellers</td>
<td align="right">9263</td>
<td align="right">2.81</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_nonsuburb_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Write the calculated values to file</span></span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span></span>
<span>    <span class="st">"2011_Leicester_pop_per_OAC_supgrp_excl_suburb.csv"</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div id="how-to-cite" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"><i class="fas fa-link"></i></a>
</h2>
<div id="references" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> References<a class="anchor" aria-label="anchor" href="#references"><i class="fas fa-link"></i></a>
</h3>
<p>Academic references can be added to RMarkdown <a href="https://bookdown.org/yihui/rmarkdown-cookbook/bibliography.html">as illustrated in the R Markdown Cookbook</a>.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references-1.html#ref-xie2020r" role="doc-biblioref"&gt;Yihui Xie, Christophe Dervieux, and Emily Riederer, &lt;em&gt;R Markdown Cookbook&lt;/em&gt; (Chapman; Hall/CRC, 2020), &lt;/a&gt;&lt;a href="https://bookdown.org/yihui/rmarkdown-cookbook/" role="doc-biblioref"&gt;https://bookdown.org/yihui/rmarkdown-cookbook/&lt;/a&gt;.&lt;/p&gt;'><sup>15</sup></a></span> Bibtex references can be added to a separate <code>.bib</code> file that is linked to in the heading of the RMarkdown document. References can then be cited using the <code>@</code> symbol followed by the reference id.</p>
<p>For instance, this documents links to the <code>references.bib</code> bibtex file, which contains the academic references, and the <code>packages.bib</code> bibtex files, which contains additional references for the R packages (see also next section), by adding the following line in the heading.</p>
<pre><code>bibliography: [references.bib, packages.bib]</code></pre>
<p>The <code>references.bib</code> contains the following reference for the R Markdown Cookbook book.</p>
<pre><code>@book{xie2020r,
  title={R markdown cookbook},
  author={Xie, Yihui and Dervieux, Christophe and Riederer, Emily},
  year={2020},
  publisher={Chapman and Hall/CRC},
  url = {https://bookdown.org/yihui/rmarkdown-cookbook/}
}</code></pre>
<p>That allows writing the first sentence of this section as follows.</p>
<pre><code>Academic references can be added to RMarkdown [as illustrated in the R Markdown Cookbook](https://bookdown.org/yihui/rmarkdown-cookbook/bibliography.html) [@xie2020r].</code></pre>
<p>Bibtex references can be obtained from most journals or by clicking on the <em>Cite</em> link under a paper in <a href="https://scholar.google.com/">Google Scholar</a> and then selecting <em>Bibtex</em>.</p>
</div>
<div id="code" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Code<a class="anchor" aria-label="anchor" href="#code"><i class="fas fa-link"></i></a>
</h3>
<p>The UK’s <a href="https://www.software.ac.uk/about">Software Sustainability Institute</a> provides clear guidance about <a href="https://www.software.ac.uk/how-cite-software">how to cite software</a> written by others. As outlined in the guidance, you should always cite and credit their work. However, using academic-style citations is not always straightforward when working with libraries, as most of them are not linked to an academic paper nor provide a <a href="https://www.doi.org/">DOI</a>. In such cases, you should at least include a link to the authors’ website or repository in the script or final report when using a library. For instance, you can add a link to the Tidyverse’s <a href="https://tidyverse.tidyverse.org/">website</a>, <a href="https://github.com/tidyverse/tidyverse">repository</a> or <a href="https://cran.r-project.org/web/packages/tidyverse/index.html">CRAN page</a> when using the library. However, <span class="citation">Wickham et al.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="references-1.html#ref-tidyverse2019" role="doc-biblioref"&gt;&lt;span&gt;“Welcome to the &lt;span class="nocase"&gt;tidyverse&lt;/span&gt;”&lt;/span&gt;&lt;/a&gt;.&lt;/p&gt;'><sup>16</sup></a></span> also wrote a paper on their work on the Tidyverse for the <a href="https://joss.theoj.org/">Journal of Open Source Software</a>, so you can also cite their paper <a href="https://bookdown.org/yihui/rmarkdown-cookbook/bibliography.html">using Bibtex in RMarkdown</a>.</p>
<!-- The two following paragraphs contain text adapted from text by Dr. Jorg D. Kaduk, jk61@leicester.ac.uk -->
<p>Appropriate citations are even more important when directly copying or adapting code from others’ work. Plagiarism principles apply to code as much as they do to text. The Massachusetts Institute of Technology (MIT)’s <a href="https://integrity.mit.edu/"><em>Academic Integrity at MIT: A Handbook for Students</em></a> includes a section on <a href="https://integrity.mit.edu/handbook/writing-code">writing code</a> which provides good guidance on when and how to cite code that you include in your projects or you adapt for your own code properly.
That also applies to re-using your own code, which you have written before. It is important that you refer to your previous work and fully acknowledge all previous work that has been used in a project so that others can find everything you have used in a project.</p>
<p>It is common practice to follow a particular referencing style for the in-text quotations, references and bibliography, such as the Harvard style (see, e.g., the <a href="https://www.mendeley.com/guides/harvard-citation-guide/">Harvard Format Citation Guide</a> available <a href="https://www.mendeley.com/">Mendeley</a>’s help pages).
Following such guidelines will not only ensure that others can more easily use and reproduce your work but also that you demonstrate academic honesty and integrity.</p>
</div>
</div>
<div id="exercises-103.1" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Exercises 103.1<a class="anchor" aria-label="anchor" href="#exercises-103.1"><i class="fas fa-link"></i></a>
</h2>
<p>Create an RMarkdown document in RStudio, using <em>Exercise 103</em> as title and <em>PDF</em> as output. Delete all the contents except the first five lines which compose the heading. Save the document as <code>practical-103_exercises.Rmd</code>. Add the libraries and code necessary to read the data from the <code>2011_OAC_Raw_uVariables_Leicester.csv</code> file. Create a first section of the document (e.g., adding a second heading <em>Exercise 103.1</em>) and add your answers to the questions below.</p>
<p>In order to answer the questions below, inspect the <strong>look-up</strong> table <code>2011_OAC_Raw_uVariables_Lookup.csv</code> (e.g., using Microsoft Excel) to identify the columns necessary to complete the task.</p>
<p><strong>Question 103.1.1:</strong> Identify the five variables which are part of the variable subdomain <em>Housing Type</em> and write the code necessary to compute the total number of household spaces in Leicester for each housing type.</p>
<p><strong>Question 103.1.2:</strong> Write the code necessary to compute the total number of household spaces in Leicester for each housing type grouped by 2011 OAC supergroup.</p>
<p><strong>Question 103.1.3:</strong> Write the code necessary to compute the percentage of household spaces (i.e., over to the total number of household spaces) in Leicester for each housing type grouped by 2011 OAC supergroup.</p>
<p><strong>Question 103.1.4:</strong> Modify the code written for <em>Question 103.1.3</em>, using <a href="https://dplyr.tidyverse.org/reference/rename.html">the verb <code>rename</code></a> to change the column names of the columns containing the percentages to names that resemble the related housing type (e.g., <code>perc_of_detached</code>).</p>
</div>
<div id="exercises-103.2" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> Exercises 103.2<a class="anchor" aria-label="anchor" href="#exercises-103.2"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Question 103.2.1:</strong> Explore the <strong>look-up</strong> table <code>2011_OAC_Raw_uVariables_Lookup.csv</code> and identify another set of variables that you think might relate to the type of housing and the 2011 OAC supergroups. Create a new section of the document (e.g., adding a second heading) and include a short text (up to 200 words) in the RMarkdown document describing and justifying the set of variables you choose.</p>
<p><strong>Question 103.2.2:</strong> Write the code necessary to conduct the same analysis conducted for <em>Question 103.1</em> but using the variables identified in <em>Question 103.2.1</em>.</p>
<p><strong>Question 103.2.3:</strong> Inspect the table obtained from your answer to <em>Question 103.1.3</em> and the table obtained from your answer to <em>Question 103.2.2</em>, and compare the results. Write a short text (up to 300 words) in the RMarkdown document reporting and discussing what the results tell you about the socio-demographic structure of Leicester.</p>
<hr>
<p><small>by <a href="https://sdesabbata.github.io/">Stefano De Sabbata</a> – text licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>, contains public sector information licensed under the <a href="http://www.nationalarchives.gov.uk/doc/open-government-licence">Open Government Licence v3.0</a>, code licensed under the <a href="https://www.gnu.org/licenses/gpl-3.0.html">GNU GPL v3.0</a>.</small></p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="reproducible-data-science.html"><span class="header-section-number">2</span> Reproducible data science</a></div>
<div class="next"><a href="table-operations.html"><span class="header-section-number">4</span> Table operations</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-manipulation"><span class="header-section-number">3</span> Data manipulation</a></li>
<li>
<a class="nav-link" href="#r-workflow"><span class="header-section-number">3.1</span> R workflow</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#r-projects"><span class="header-section-number">3.1.1</span> R Projects</a></li></ul>
</li>
<li><a class="nav-link" href="#data-2011-census-and-oac"><span class="header-section-number">3.2</span> Data: 2011 Census and OAC</a></li>
<li>
<a class="nav-link" href="#read-and-write-data"><span class="header-section-number">3.3</span> Read and write data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#file-paths"><span class="header-section-number">3.3.1</span> File paths</a></li></ul>
</li>
<li>
<a class="nav-link" href="#data-manipulation-1"><span class="header-section-number">3.4</span> Data manipulation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#summarise"><span class="header-section-number">3.4.1</span> Summarise</a></li>
<li><a class="nav-link" href="#mutate"><span class="header-section-number">3.4.2</span> Mutate</a></li>
<li><a class="nav-link" href="#arrange"><span class="header-section-number">3.4.3</span> Arrange</a></li>
<li><a class="nav-link" href="#data-manipulation-example"><span class="header-section-number">3.4.4</span> Data manipulation example</a></li>
<li><a class="nav-link" href="#componentization"><span class="header-section-number">3.4.5</span> Componentization</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#how-to-cite"><span class="header-section-number">3.5</span> How to cite</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#references"><span class="header-section-number">3.5.1</span> References</a></li>
<li><a class="nav-link" href="#code"><span class="header-section-number">3.5.2</span> Code</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exercises-103.1"><span class="header-section-number">3.6</span> Exercises 103.1</a></li>
<li><a class="nav-link" href="#exercises-103.2"><span class="header-section-number">3.7</span> Exercises 103.2</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/sdesabbata/r-for-geographic-data-science/blob/main/src/book/103-data-manipulation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/sdesabbata/r-for-geographic-data-science/edit/main/src/book/103-data-manipulation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Geographic Data Science</strong>" was written by Stefano De Sabbata. It was last built on 2022-10-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
